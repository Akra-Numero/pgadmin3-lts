<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>SPI_finish</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 7.4beta2 Documentation"
HREF="index.html"><LINK
REL="UP"
TITLE="Interface Functions"
HREF="spi.html#SPI-INTERFACE"><LINK
REL="PREVIOUS"
TITLE="SPI_connect"
HREF="spi-spiconnect.html"><LINK
REL="NEXT"
TITLE="SPI_exec"
HREF="spi-spiexec.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
NAME="creation"
CONTENT="2003-08-27T02:55:32"></HEAD
><BODY
CLASS="REFENTRY"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PostgreSQL 7.4beta2 Documentation</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="spi-spiconnect.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="spi-spiexec.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="SPI-SPIFINISH"
></A
>SPI_finish</H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="AEN32424"
></A
><H2
>Name</H2
>SPI_finish&nbsp;--&nbsp;   Disconnects your procedure from the SPI manager.<A
NAME="IX-SPI-SPIFINISH-1"
></A
><A
NAME="IX-SPI-SPIFINISH-2"
></A
></DIV
><DIV
CLASS="REFSYNOPSISDIV"
><A
NAME="AEN32432"
></A
><H2
>Synopsis</H2
><PRE
CLASS="SYNOPSIS"
>SPI_finish(void)</PRE
><DIV
CLASS="REFSECT2"
><A
NAME="R2-SPI-SPIFINISH-1"
></A
><H3
>Inputs</H3
><P
>None</P
></DIV
><DIV
CLASS="REFSECT2"
><A
NAME="R2-SPI-SPIFINISH-2"
></A
><H3
>Outputs</H3
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
>int</DT
><DD
><P
><P
></P
><TABLE
BORDER="0"
><TBODY
><TR
><TD
><SPAN
CLASS="RETURNVALUE"
>SPI_OK_FINISH</SPAN
>
   if properly disconnected</TD
></TR
><TR
><TD
><SPAN
CLASS="RETURNVALUE"
>SPI_ERROR_UNCONNECTED</SPAN
>
   if called from an un-connected procedure</TD
></TR
></TBODY
></TABLE
><P
></P
></P
></DD
></DL
></DIV
></DIV
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-SPI-SPIFINISH-1"
></A
><H2
>Description</H2
><P
><CODE
CLASS="FUNCTION"
>SPI_finish</CODE
> closes an existing connection to the
SPI manager.
   You must call this function after completing the SPI operations needed
   during your procedure's current invocation.</P
><P
>   You may get the error return <SPAN
CLASS="RETURNVALUE"
>SPI_ERROR_UNCONNECTED</SPAN
> if <CODE
CLASS="FUNCTION"
>SPI_finish</CODE
> is
   called without having a current valid connection.
 There is no fundamental problem
   with this; it means that nothing was done by the SPI manager.</P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-SPI-SPIFINISH-2"
></A
><H2
>Usage</H2
><P
>   <CODE
CLASS="FUNCTION"
>SPI_finish</CODE
> <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>must</I
></SPAN
> be called as a final step by a connected procedure,
 or you may get
   unpredictable results!  However, you do not need to worry about making
this happen if the transaction is aborted via elog(ERROR).  In that case
SPI will clean itself up.&#13;</P
></DIV
><DIV
CLASS="REFSECT1"
><A
NAME="R1-SPI-SPIFINISH-3"
></A
><H2
>Algorithm</H2
><P
><CODE
CLASS="FUNCTION"
>SPI_finish</CODE
> performs the following:
   Disconnects your procedure from the SPI manager and frees all memory
   allocations made by your procedure via <CODE
CLASS="FUNCTION"
>palloc</CODE
> since
 the <CODE
CLASS="FUNCTION"
>SPI_connect</CODE
>. 
   These allocations can't be used any more! See Memory management.</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="spi-spiconnect.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="spi-spiexec.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>SPI_connect</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="spi.html#SPI-INTERFACE"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>SPI_exec</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>