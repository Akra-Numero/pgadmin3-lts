<HTML
><HEAD
><TITLE
>Installing Procedural Languages</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.73
"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 7.3.3 Documentation"
HREF="index.html"><LINK
REL="UP"
TITLE="Procedural Languages"
HREF="xplang.html"><LINK
REL="PREVIOUS"
TITLE="Procedural Languages"
HREF="xplang.html"><LINK
REL="NEXT"
TITLE="PL/pgSQL - SQL Procedural Language"
HREF="plpgsql.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
NAME="creation"
CONTENT="2003-05-24T21:33:34"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PostgreSQL 7.3.3 Documentation</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="xplang.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 18. Procedural Languages</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="plpgsql.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="XPLANG-INSTALL"
>18.2. Installing Procedural Languages</A
></H1
><P
>    A procedural language must be <SPAN
CLASS="QUOTE"
>"installed"</SPAN
> into each
    database where it is to be used.  But procedural languages installed in
    the template1 database are automatically available in all
    subsequently created databases. So the database administrator can
    decide which languages are available in which databases, and can make
    some languages available by default if he chooses.
   </P
><P
>    For the languages supplied with the standard distribution, the
    shell script <TT
CLASS="FILENAME"
>createlang</TT
> may be used instead
    of carrying out the details by hand.  For example, to install <SPAN
CLASS="APPLICATION"
>PL/pgSQL</SPAN
>
    into the template1 database, use
</P><PRE
CLASS="PROGRAMLISTING"
>createlang plpgsql template1</PRE
><P>
    The manual procedure described below is only recommended for
    installing custom languages that <TT
CLASS="FILENAME"
>createlang</TT
>
    does not know about.
   </P
><DIV
CLASS="PROCEDURE"
><P
><B
>     Manual Procedural Language Installation
    </B
></P
><P
>     A procedural language is installed in the database in three
     steps, which must be carried out by a database superuser.
    </P
><OL
TYPE="1"
><LI
><P
>      The shared object for the language handler must be compiled and
      installed into an appropriate library directory.  This works in the same
      way as building and installing modules with regular user-defined C
      functions does; see <A
HREF="xfunc-c.html#DFUNC"
>Section 9.5.8</A
>.
     </P
></LI
><LI
><A
NAME="XPLANG-INSTALL-CR1"
></A
><P
>      The handler must be declared with the command
</P><PRE
CLASS="SYNOPSIS"
>CREATE FUNCTION <TT
CLASS="REPLACEABLE"
><I
>handler_function_name</I
></TT
> ()
    RETURNS LANGUAGE_HANDLER AS
    '<TT
CLASS="REPLACEABLE"
><I
>path-to-shared-object</I
></TT
>' LANGUAGE C;</PRE
><P>
      The special return type of <TT
CLASS="TYPE"
>LANGUAGE_HANDLER</TT
> tells
      the database that this function does not return one of
      the defined <SPAN
CLASS="ACRONYM"
>SQL</SPAN
> data types and is not directly usable
      in <SPAN
CLASS="ACRONYM"
>SQL</SPAN
> statements.
     </P
></LI
><LI
><A
NAME="XPLANG-INSTALL-CR2"
></A
><P
>      The PL must be declared with the command
</P><PRE
CLASS="SYNOPSIS"
>CREATE [<SPAN
CLASS="OPTIONAL"
>TRUSTED</SPAN
>] [<SPAN
CLASS="OPTIONAL"
>PROCEDURAL</SPAN
>] LANGUAGE <TT
CLASS="REPLACEABLE"
><I
>language-name</I
></TT
>
    HANDLER <TT
CLASS="REPLACEABLE"
><I
>handler_function_name</I
></TT
>;</PRE
><P>
      The optional key word <TT
CLASS="LITERAL"
>TRUSTED</TT
> tells whether
      ordinary database users that have no superuser privileges should
      be allowed to use this language to create functions and trigger
      procedures. Since PL functions are executed inside the database
      server, the <TT
CLASS="LITERAL"
>TRUSTED</TT
> flag should only be given
      for languages that do not allow access to database server
      internals or the file system. The languages
      <SPAN
CLASS="APPLICATION"
>PL/pgSQL</SPAN
>,
      <SPAN
CLASS="APPLICATION"
>PL/Tcl</SPAN
>,
      <SPAN
CLASS="APPLICATION"
>PL/Perl</SPAN
>, and
      <SPAN
CLASS="APPLICATION"
>PL/Python</SPAN
> are known to be trusted;
      the languages <SPAN
CLASS="APPLICATION"
>PL/TclU</SPAN
> and
      <SPAN
CLASS="APPLICATION"
>PL/PerlU</SPAN
> are designed to provide
      unlimited functionality should <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>not</I
></SPAN
> be
      marked trusted.
     </P
></LI
></OL
></DIV
><P
>    In a default <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> installation,
    the handler for the <SPAN
CLASS="APPLICATION"
>PL/pgSQL</SPAN
> language
    is built and installed into the <SPAN
CLASS="QUOTE"
>"library"</SPAN
>
    directory. If <SPAN
CLASS="APPLICATION"
>Tcl/Tk</SPAN
> support is configured in, the handlers for
    <SPAN
CLASS="APPLICATION"
>PL/Tcl</SPAN
> and <SPAN
CLASS="APPLICATION"
>PL/TclU</SPAN
> are also built and installed in the same
    location.  Likewise, the <SPAN
CLASS="APPLICATION"
>PL/Perl</SPAN
> and <SPAN
CLASS="APPLICATION"
>PL/PerlU</SPAN
> handlers are built
    and installed if Perl support is configured, and <SPAN
CLASS="APPLICATION"
>PL/Python</SPAN
> is
    installed if Python support is configured.  The
    <TT
CLASS="FILENAME"
>createlang</TT
> script automates <A
HREF="xplang-install.html#XPLANG-INSTALL-CR1"
>step 2</A
> and <A
HREF="xplang-install.html#XPLANG-INSTALL-CR2"
>step 3</A
> described above.
   </P
><DIV
CLASS="EXAMPLE"
><A
NAME="AEN35493"
></A
><P
><B
>Example 18-1. Manual Installation of <SPAN
CLASS="APPLICATION"
>PL/pgSQL</SPAN
></B
></P
><P
>      The following command tells the database server where to find the 
      shared object for the <SPAN
CLASS="APPLICATION"
>PL/pgSQL</SPAN
> language's call handler function.

</P><PRE
CLASS="PROGRAMLISTING"
>CREATE FUNCTION plpgsql_call_handler () RETURNS LANGUAGE_HANDLER AS
    '$libdir/plpgsql' LANGUAGE C;</PRE
><P>
     </P
><P
>      The command
</P><PRE
CLASS="PROGRAMLISTING"
>CREATE TRUSTED PROCEDURAL LANGUAGE plpgsql
    HANDLER plpgsql_call_handler;</PRE
><P>
      then defines that the previously declared call handler function
      should be invoked for functions and trigger procedures where the
      language attribute is <TT
CLASS="LITERAL"
>plpgsql</TT
>.
     </P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="xplang.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="plpgsql.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Procedural Languages</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="xplang.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><SPAN
CLASS="APPLICATION"
>PL/pgSQL</SPAN
> - <SPAN
CLASS="ACRONYM"
>SQL</SPAN
> Procedural Language</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>