<HTML
><HEAD
><TITLE
>Creating a Database Cluster</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.73
"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 7.3.3 Documentation"
HREF="index.html"><LINK
REL="UP"
TITLE="Server Run-time Environment"
HREF="runtime.html"><LINK
REL="PREVIOUS"
TITLE="Server Run-time Environment"
HREF="runtime.html"><LINK
REL="NEXT"
TITLE="Starting the Database Server"
HREF="postmaster-start.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
NAME="creation"
CONTENT="2003-05-24T21:33:34"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PostgreSQL 7.3.3 Documentation</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="runtime.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 3. Server Run-time Environment</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="postmaster-start.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="CREATING-CLUSTER"
>3.2. Creating a Database Cluster</A
></H1
><A
NAME="AEN19190"
></A
><A
NAME="AEN19192"
></A
><P
>   Before you can do anything, you must initialize a database storage
   area on disk. We call this a <I
CLASS="FIRSTTERM"
>database cluster</I
>.
   (<SPAN
CLASS="ACRONYM"
>SQL</SPAN
> uses the term catalog cluster instead.) A
   database cluster is a collection of databases is accessible by a
   single instance of a running database server. After initialization, a
   database cluster will contain a database named
   <TT
CLASS="LITERAL"
>template1</TT
>. As the name suggests, this will be used
   as a template for subsequently created databases; it should not be
   used for actual work.  (See <A
HREF="managing-databases.html"
>Chapter 5</A
> for information
   about creating databases.)
  </P
><P
>   In file system terms, a database cluster will be a single directory
   under which all data will be stored. We call this the <I
CLASS="FIRSTTERM"
>data
   directory</I
> or <I
CLASS="FIRSTTERM"
>data area</I
>. It is
   completely up to you where you choose to store your data.  There is no
   default, although locations such as
   <TT
CLASS="FILENAME"
>/usr/local/pgsql/data</TT
> or
   <TT
CLASS="FILENAME"
>/var/lib/pgsql/data</TT
> are popular. To initialize a
   database cluster, use the command <TT
CLASS="COMMAND"
>initdb</TT
>, which is
   installed with <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>. The desired
   file system location of your database system is indicated by the
   <TT
CLASS="OPTION"
>-D</TT
> option, for example
</P><PRE
CLASS="SCREEN"
><TT
CLASS="PROMPT"
>$</TT
> <TT
CLASS="USERINPUT"
><B
>initdb -D /usr/local/pgsql/data</B
></TT
></PRE
><P>
   Note that you must execute this command while logged into the
   <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> user account, which is
   described in the previous section.
  </P
><DIV
CLASS="TIP"
><BLOCKQUOTE
CLASS="TIP"
><P
><B
>Tip: </B
>    <A
NAME="AEN19214"
></A
>
    As an alternative to the <TT
CLASS="OPTION"
>-D</TT
> option, you can set
    the environment variable <TT
CLASS="ENVAR"
>PGDATA</TT
>.
   </P
></BLOCKQUOTE
></DIV
><P
>   <TT
CLASS="COMMAND"
>initdb</TT
> will attempt to create the directory you
   specify if it does not already exist. It is likely that it will not
   have the permission to do so (if you followed our advice and created
   an unprivileged account). In that case you should create the
   directory yourself (as root) and change the owner to be the
   <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> user. Here is how this might
   be done:
</P><PRE
CLASS="SCREEN"
>root# <TT
CLASS="USERINPUT"
><B
>mkdir /usr/local/pgsql/data</B
></TT
>
root# <TT
CLASS="USERINPUT"
><B
>chown postgres /usr/local/pgsql/data</B
></TT
>
root# <TT
CLASS="USERINPUT"
><B
>su postgres</B
></TT
>
postgres$ <TT
CLASS="USERINPUT"
><B
>initdb -D /usr/local/pgsql/data</B
></TT
></PRE
><P>
  </P
><P
>   <TT
CLASS="COMMAND"
>initdb</TT
> will refuse to run if the data directory
   looks like it it has already been initialized.</P
><P
>   Because the data directory contains all the data stored in the
   database, it is essential that it be secured from unauthorized
   access. <TT
CLASS="COMMAND"
>initdb</TT
> therefore revokes access
   permissions from everyone but the
   <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> user.
  </P
><P
>   However, while the directory contents are secure, the default
   client authentication setup allows any local user to connect to the
   database and even become the database superuser. If you don't trust
   other local users, we recommend you use <TT
CLASS="COMMAND"
>initdb</TT
>'s
   <TT
CLASS="OPTION"
>-W</TT
> or <TT
CLASS="OPTION"
>--pwprompt</TT
> option to assign a
   password to the database superuser. After <TT
CLASS="COMMAND"
>initdb</TT
>,
   modify the <TT
CLASS="FILENAME"
>pg_hba.conf</TT
> file to use <TT
CLASS="LITERAL"
>md5</TT
> or
   <TT
CLASS="LITERAL"
>password</TT
> instead of <TT
CLASS="LITERAL"
>trust</TT
> authentication
   <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>before</I
></SPAN
> you start the server for the first time. (Other,
   approaches include using <TT
CLASS="LITERAL"
>ident</TT
> authentication or
   file system permissions to restrict connections. See <A
HREF="client-authentication.html"
>Chapter 6</A
> for more information.)
  </P
><P
>   <A
NAME="AEN19245"
></A
>
   <A
NAME="AEN19247"
></A
>
   <TT
CLASS="COMMAND"
>initdb</TT
> also initializes the default locale for
   the database cluster.  Normally, it will just take the locale
   settings in the environment and apply them to the initialized
   database.  It is possible to specify a different locale for the
   database; more information about that can be found in <A
HREF="charset.html#LOCALE"
>Section 7.1</A
>.  One surprise you might encounter while running
   <TT
CLASS="COMMAND"
>initdb</TT
> is a notice similar to this:
</P><PRE
CLASS="SCREEN"
>The database cluster will be initialized with locale de_DE.
This locale setting will prevent the use of indexes for pattern matching
operations.  If that is a concern, rerun initdb with the collation order
set to "C".  For more information see the Administrator's Guide.</PRE
><P>
   This is intended to warn you that the currently selected locale
   will cause indexes to be sorted in an order that prevents them from
   being used for <TT
CLASS="LITERAL"
>LIKE</TT
> and regular-expression searches. If you need
   good performance in such searches, you should set your current
   locale to <TT
CLASS="LITERAL"
>C</TT
> and re-run <TT
CLASS="COMMAND"
>initdb</TT
>, e.g.,
   by running <TT
CLASS="LITERAL"
>initdb --lc-collate=C</TT
>. The sort
   order used within a particular database cluster is set by
   <TT
CLASS="COMMAND"
>initdb</TT
> and cannot be changed later, short of
   dumping all data, rerunning <TT
CLASS="COMMAND"
>initdb</TT
>, and
   reloading the data. So it's important to make this choice correctly
   the first time.
  </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="runtime.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="postmaster-start.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Server Run-time Environment</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="runtime.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Starting the Database Server</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>